<title>Shared Todo App</title>

<div class="container">

<div class="row">

<div class="span12">

<h1>Projects</h1>

<hr>

<%= form_for @new_todo, :url => { :action => "add", :controller => "todos" } do |f| %>

  <%= f.hidden_field :todo_project, :value => params[:project] %>
  <%= f.text_field :todo_item %>
  <%= f.submit "Add To Do", class: "btn btn-primary" %>

<% end %>

<% if !flash[:error].nil? %>

  <div class="alert alert-error">

    <button type="button" class="close" data-dismiss="alert" >x</button>

    <strong><%= flash[:error] %></strong>

  </div>

<% end %>

<% if flash[:success] %>

  <div class="alert alert-success">

     <button type="button" class="close" data-dismiss="alert" >x</button>

    <strong><%= flash[:success] %></strong>

  </div>

<% end %>

<%= form_tag("/todos/complete/", :method => "post") do %>

<div class="span12">

	<%= submit_tag("Complete", :class=>"btn btn-success", :name=>"complete_todo") %>
	<%= submit_tag("Delete", :class=>"btn btn-danger", :name=>"delete_todo") %>
	

</div> <!-- span12 -->

<hr><br>

<div class="span12">

	<table class="table table-striped">
		
		<thead>
	
			<tr>
				<th></th>
				<th>To Do Item</th>
				<th>Deadline</th>
				<th>Importance</th>
				<th>Hours Still Required</th>
				<th>% Completion</th>
			</tr>

		</thead>

		<tbody>      

			<% @project_todos.each do |t| %>
				
				<tr>	
					<td><%= check_box_tag "todos_checkbox[]",t.id %></td>
					<td>
						<% if t.todo_complete == true %>
          
							<strike><%= t.todo_item %></strike>
	
						<% else %>
						
							<%= link_to t.todo_item, details_path(t.id) %>
						<% end %>
					</td>
					<td><%= t.todo_deadline %></td>
					<td><%= t.todo_importance %></td>
					<td><%= if t.todo_complete == true then 0 else number_with_precision(t.todo_timeremaining, precision: 2) end %></td>
					<td><%= (if t.todo_complete == true then 100 else (100-(t.todo_timeremaining*100/t.todo_timerequired)) end).to_i %>%</td>

				</tr>

			<% end %>

		</tbody>
	</table>	

</div> <!-- span12 -->

<% end %>

</div> <!-- span12 -->

</div> <!-- row -->

</div> <!-- container -->
